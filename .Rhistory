x
y <- x**2
lm(y~x)
library(swirl)
install_from_swirl("Regression Models")
swirl()
plot(child~parent,galton)
plot(jitter(child,4)~parent,galton)
regrline <- lm(child~parent,galton)
abline(regrline,lwd=3,col="red")
summary(regrline)
lm(child~parent,galton)
fit <- lm(child~parent,galton)
summary(fit)
mean(fit$residuals)
cov(fit$residuals,galton$parent)
ols.ic <- fit$coefficients[1]
ols.ic <- fit$coef[1]
ols.slope <- fit$coef[2]
rhs-lhs
lhs-rhs
all.equal(rhs,lhs)
varChild <- var(galton$child)
varRes <- var(fit$residuals)
varEst <- var(est(ols.slope,ols.ic))
all.equal(varChild,varRes+varEst)
efit <- lm(accel~mag+dist,attenu)
mean(efit$residuals)
cov(efit$residuals,attenu$mag)
cov(efit$residuals,attenu$dist)
cor(gpa_nor,gch_nor)
l_nor <- lm(gch_nor~gpa_nor)
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
y <- w*c
w <- c(2, 1, 3, 1)
w <- c(2, 1, 3, 1)
x <- c(0.18, -1.54, 0.42, 0.95)
y <- w %*% x
1.03/4
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
data("mtcars")
lm(mtcars$mpg,mtcars$wt)
lm(mtcars$mpg~mtcars$wt)
0.4*1.5
x <- c(8.58, 10.46, 9.01, 9.64, 8.86)
mu <- mean(x)
sde <- sd(x)
(8.58-mu)/sde
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
mean(x)
x <- c(0.18, -1.54, 0.42, 0.95)
x <- c(0.18*2, -1.54*1, 0.42*3, 0.95)
mean(x)
x <- c(0.18, -1.54, 0.42, 0.95)
mean(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
mean(x) - mean(y)
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
weighted.mean(w,x)
weighted.mean(x,w)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x-1)
swirl()
fit <- lm(child~parent,galton)
sqrt((1/n-2) * sum(fit$residuals^2))
sqrt(sum(fit$residuals^2)/(n-2))
summary(fit)$sigma
sqrt(deviance(fit)/(n-2))
mu <- mean(galton$child)
sTot <- sum((galton$child^2))
sTot <- sum(((galton$child-mu)^2))
sTot <- sum((galton$child-mu)^2)
sRes <- deviance(fit$residuals)
sRes <- deviance(fit$residuals)
sRes <- deviance(fit)
1 - (sRes/sTot)
1 - sRes/sTot
summary(fit)$r.squared
cor(galton$child,galton$parent)
cor(galton$child,galton$parent)2
cor(galton$child,galton$parent)^2
ones <- rep(1,nrow(galton))
lm(child~ones + parent-1,galton)
lm(child~parent,galton)
lm(child~1,galton)
head(trees)
fit <- lm(Volume~Girth + Height + Constant - 1,trees)
trees2 <- eliminate("Girth",trees)
head(trees2)
fit2 <- lm(Volume~Height+Constant-1,trees2)
lapply(list(fit,fit2),coef)
lm(Fertility~.,swiss)
all <- lm(Fertility~.,swiss)
summary(all)
summary(lm(Fertlity~Agriculture,swiss))
summary(lm(Fertility~Agriculture,swiss))
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelms()
ec <- swiss$Examination + swiss$Catholic
efit <- lm(Fertility~.+ec,swiss)
efit$coef - all$coef
all$coef - efit$coef
all$coefficients - efit$coefficients
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
lm(y~x)
summary(lm(y~x))
data("mtcars")
fit <- lm(mpg~weight,mtcars)
fit <- lm(mpg~wt,mtcars)
summary(fit)
summary(fit)$coeffecients
fit$coefficients
summary(fit)$Coeffecients
-5.3445 - qt(0.975,df = 30) * 0.5591
?mtcars
predict(fit,newdata = 3000,interval = "prediction")
predict(fit,newdata = data.frame(3000),interval = "prediction")
predict(fit,newdata = data.frame(wt = 3000),interval = "prediction")
head(mtcars)
predict(fit,newdata = data.frame(wt = 3),interval = "prediction")
predict(fit,newdata = data.frame(wt = 2),interval = "prediction")
predict(fit,newdata = data.frame(wt = 2),interval = "prediction") - mean(mtcars$mpg)
summary(lm(mpg~I(wt+1),mtcars))
-5.3445
-5.3445 - qt(0.975,)
-5.3445 - qt(0.975,30) * 0.5591
summary(lm(mpg~I(wt+2),mtcars))
summary(lm(mpg~I(wt*2),mtcars))
-2.6722 - qt(0.975,30) * 0.2796
summary(lm(mpg~I(wt/2),mtcars))
-10.689 - qt(0.975,30) * 1.118
summary(fit)
summary(fit)$coef
confint(summary(fit)$coef[2,])
confint(fit)[2,]
confint(lm(mpg~1,mtcars))[2,]
confint(lm(mpg~1,mtcars))[1,]
predict(fit,newdata = data.frame(wt=mean(mtcars$wt)),interval = "prediction")
predict(fit,newdata = data.frame(wt=mean(mtcars$wt)),interval = "confidence")
deviance(fit)
fit2 <- lm(mpg~1,mtcars)
deviance(fit2/deviance(fit))
deviance(fit2)/deviance(fit)
deviance(fit)/deviance(fit2)
x <- c(1,20,30,40)
y <- c(1,400,800,1300)
lm(y~x)
lm(y~x-1)
28.96-27.5
30.01-28.96
0.5*log(0.5)
log(0.5)
406/500
50/60
50/5
50/55
2*0.83*0.9/(0.83+0.9)
p <- 50/60
r <- 50/55
2*p*r/(p+r)
15/35
10/30
5/65
15/35
35/80
20/30
p <- 47/57
r <- 47/50
2*p*r/(p+r)
50/(50+15)
50/55
104/154
85/110
p <- 70/85
r<- 70/95
2*p*r/(p+r)
65/75
65/80
65/75
406/500
65/80
10/50
85/110
60/(60+10)
94/(94+104+302)
47/50
47/57
406/(406+50+44)
library(swirl)
swirl()
6
dim(InsectSprays)
head(InsectSprays,15)
names(sA)
names(sB)
names(SB)
sB
summary(InsectSprays$spray)
summary(InsectSprays[,2])
summary(InsectSprays,class)
sapply(InsectSprays, class)
fit <- lm(count~spray,data = InsectSprays)
summary(fit)$coef
est <- summary(fit)$coef[,1]
mean(sA)
mean(sA)
mean(sB)
nfit <- lm(count~spray-1,data = InsectSprays)
summary(nfit)$coef
spray2 <- relevel(InsectSprays$spray,"C")
fit2 <- lm(count~spray,data = spray2)
fit2 <- lm(count~spray2,data = InsectSprays)
summary(fit2)$coef
mean(sC)
(fit$coefficients[2] - fit$coefficients[3])/1.6011
(fit$coef[2] - fit$coef[3])/1.6011
dim(hunger)
948
names(hunger)
fit <- lm(Numeric~Year,data = hunger)
summary(fit)$coef
lmF <- lm(Numeric~Year,data = hunger[hunger$Sex=="Female"])
lmF <- lm(Numeric~Year,data = hunger[hunger$Sex=="Female",])
lmF <- lm(Numeric[Sex=="Female"] ~ Year[Sex=="Female"],hunger)
lmM <- lm(Numeric[Sex=="Male"] ~ Year[Sex=="Male"],hunger)
lmBoth <- lm(Numeric~Year+Sex,data = hunger)
summary(lmBoth)
lmInter <- lm(Numeric~Year+Sex+Sex*Year,data = hunger)
summary(lmInter)
fit <- lm(y~x,out2)
plot(fit,which = 1)
fitno <- lm(y~x,out2[-1,])
plot(fitno,which = 1)
coef(fit) * coef(fitno)
coef(fit) - coef(fitno)
head(dfbeta(fit))
resno <- out2[1,"y"] - predict(fitno,out2[1,])
1-resid(fit)[1]/resno
head(hatvalues(fit))
sigma <- sqrt(deviance(fit)/summary(fit)$df)
sigma <- sqrt(deviance(fit)/df.residual(fit))
rstd <- sigma * sqrt(1-hatvalues(fit))
rstd <- resid(fit) / (sigma * sqrt(1-hatvalues(fit)))
head(cbind(rstd,rstandard(fit)))
plot(fit,which = 3)
plot(fit,which = 2)
sigma1 <- sqrt(deviance(fitno)/df.residual(fitno))
sigma1 * sqrt(1-hatvalues(fit)[1]) /resid(fit)[1]
resid(fit)[1]  / (sigma1 * sqrt(1-hatvalues(fit)[1]))
head(rstudent(fit))
dy <- predict(fitno,out2) - predict(fit,out2)
dy/(2*sigma^2)
sum(dy^2)/(2*sigma^2)
plot(fit,which = 5)
data("mtcars")
names(mtcars)
lm(mpg~cyl+wt,mtcars)
lm(mpg~factor(cyl)+wt,mtcars)
lm(mpg~factor(cyl),mtcars)
fit1 <- lm(mpg~factor(cyl)+wt,mtcars)
fit3 <- lm(mpg~factor(cyl)+wt+factor(cyl)*wt,mtcars)
anova(fit1,fit3)
lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit4 <- lm(y~x)
hatvalues(fit4)
dfbeta(fit4)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit5 <- lm(y~x)
dfbeta(fit5)
cooks.distance(fit5)
dfbetas(fit5)
install.packages("devtools")
devtools::install_github("jhudsl/collegeIncome")
library(collegeIncome)
data(college)
devtools::install_github("jhudsl/matahari")
library(matahari)
dance_start(value = FALSE, contents = FALSE)
dim(college)
head(college)
summary(college)
unique(college$major_category)
college$major_category <- factor(college$major_category)
unique(college$major_category)
fit <- lm(median~major_category,data = college)
summary(fit)$coef
boxplot(college$median,college$major_category)
boxplot(college$median,college$major_code)
library(ggplot2)
g <- ggplot(data = college,aes(x=major_category,y=median))
g + geom_boxplot()
g + geom_boxplot() + theme(axis.text.x = element_text(angle = 90,vjust = 0.5,hjust = 1))
dance_save("~/Desktop/college_major_analysis.rds")
dance_save("~/college_major_analysis.rds")
resid <- residuals(fit)
fitted <- fitted.values(fit)
plot(density(resid),xlab = "Residuals",ylab = "Density")
plot(fitted,resid)
(96+19)/(96+19+12)
round((96+19)/(96+19+12),3)
round(96/104)
round(96/104,3)
library(swirl)
swirl()
rgp1()
rgp2()
head(swiss)
mdl <- lm(Fertility~.,data = swiss)
vif(mdl)
mdl2 <- lm(Fertility~.-Examination,data = swiss)
vif(mdl2)
x1c <- simbias()
apply(x1c,1,mean)
fit1 <- lm(Fertility~Agriculture,data = swiss)
fit3 <- lm(Fertility~Agriculture+Examination+Education,data = swiss)
Anova(fit1,fit3)
anova(fit1,fit3)
deviance(fit3)
d <- deviance(fit3)/43
n <- (deviance(fit1) - deviance(fit3))/2
n/d
pf(n/d,2,43,lower.tail = FALSE)
shapiro.test(fit3$residuals)
anova(fit1,fit3,fit5,fit6)
View(ravenData)
mdl <- glm(ravenWinNum~ravenScore,"binomial",data = ravenData)
lodds <- predict(mdl,data.frame(ravenScore=c(0,3,6)))
exp(lodds)/(1+exp(lodds))
summary(mld)
summary(mdl)
confint(mdl)
exp(confint(mdl))
anova(mdl)
qchisq(0.95,1)
var(rpois(1000,50))
nxt()
head(hits)
class(hits$date)
as.integer(hits$date)
as.integer(head(hits$date))
mdl <- glm(Visits~date,poisson,hits)
mdl <- glm(visits~date,poisson,hits)
summary(mdl)
confint(mdl,'date')
exp(confint(mdl,'date'))
which.max(hits$visits)
hits[704,]
lambda <- mdl$fitted.values[704]
qpois(0.95,lambda)
mdl2 <- glm(visits~.,poisson,data = hits,offset = log(visits+1))
mdl2 <- glm(simplystats~date,poisson,data = hits,offset = log(visits+1))
qpois(0.95,mdl2$fitted.values[704])
library(MASS)
data("shuttle")
summary(shuttle)
fit <- glm(use~wind,data = shuttle)
fit <- glm(factoy(use)~factor(wind),data = shuttle)
fit <- glm(factor(use)~factor(wind),data = shuttle)
shuttle$use
fit <- glm(factor(use)~factor(wind),"binomial",data = shuttle)
summary(fit)
exp(confint(fit))
exp(fit$coefficients)
fit2 <- glm(factor(use)~factor(wind)+magn,"binomial",data = shuttle)
exp(fit2$coefficients)
fit2 <- glm(factor(use)~1-factor(wind)+magn,"binomial",data = shuttle)
exp(fit2$coefficients)
fit2 <- glm(factor(use)~factor(1-wind)+magn,"binomial",data = shuttle)
data("InsectSprays")
force(InsectSprays)
fit3 <- glm(count~factor(spray),poisson,data = InsectSprays)
summary(fit3)
exp(fit3$coefficients)
exp(coef(fit3))
fit3 <- glm(count~factor(spray)-1,poisson,data = InsectSprays)
exp(coef(fit3))
14.5/15.33
?offset
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
plot(y ~ x)
d1 <- c(0, 0 ,0, 0, 0,  0,  1 , 1,  1 , 1 , 1)
d2 <- c(1, 1 ,1, 1, 1,  1,  0 , 0,  0, 0 , 0)
summary(lm(y ~ d1*x))
z <- (x > 0) * x
fit <- lm(y ~ x + z)
fit <- lm(y ~ x + z)
sum(coef(fit)[2:3])
fit <- glm(factor(use)~factor(wind),"binomial",data = shuttle)
summary(fit)
summary(shuttle$wind)
str(shuttle$wind)
levels(shuttle$wind)
shuttle$wind <- relevel(shuttle$wind,"tail")
levels(shuttle$wind)
fit <- glm(factor(use)~factor(wind),"binomial",data = shuttle)
summary(fit)
setwd("D:/Coursera - Data Science Specialization/Regression Models")
data("mtcars")
summary(mtcars)
str(mtcars)
?mtcars
mtcars$am <- factor(mtcars$am,0)
?mtcars
str(mtcars)
data("mtcars")
factor(mtcars$am)
mtcars$am <- factor(mtcars$am)
library(ggplot2)
g <- ggplot(data = mtcars, aes(x = am,y = mpg))
g + boxplot()
g + boxplot(am)
g + boxplot(mtcars$am)
g + boxplot(mtcars$am,mtcars$mpg)
tapply(mtcars$mpg,mtcars$am,mean)
g + geom_boxplot()
fit <- lm(mpg~.,data = mtcars)
summary(fit)
fit2 <- lm(mpg~am,data = mtcars)
summary(fit2)
plot(fit2)
plot(fit2,1)
?mtcars
g + geom_boxplot()
t.test(mtcars$mpg~mtcars$am)
pairs(mtcars)
library(GGally)
install.packages(GGally)
install.packages("GGally")
install.packages("GGally")
install.packages("GGally")
install.packages("GGally")
library(GGally)
ggpais(mtcars)
ggpairs(mtcars)
library(GGally)
ggpairs(mtcars)
fit_am <- lm(mpg~am, data = mtcars)
summary(fit_am)
fit_all <- lm(mpg~.,data = mtcars)
summary(fit_all)
vif(fit_all)
library(car)
vif(fit_all)
fit1 <- lm(mpg~am,data = mtcars)
fit2 <- lm(mpg~wt+am, data = mtcars)
anova(fit1,fit2)
fit3 <- lm(mpg~am+wt+disp,data = mtcars)
anova(fit1,fit2,fit3)
fit4 <- lm(mpg~am+wt+hp,data = mtcars)
anova(fit1,fit2,fit4)
summary(fit4)
fit5 <- lm(mpg~am+wt+hp+cyl,data = mtcars)
anova(fit1,fit2,fit4,fit5)
fit4 <- lm(mpg~am+wt+disp+hp,data = mtcars)
fit5 <- lm(mpg~am+wt+disp + hp+ cyl,data = mtcars)
fit6 <- lm(mpg~am+wt+disp+hp+cyl+vs, data = mtcars)
anova(fit1,fit2,fit4,fit5,fit6)
anova(fit1,fit2,fit3,fit4,fit5,fit6)
best_fit <- step(fit_all,direction = "both",trace = FALSE)
summary(best_fit)
vif(best_fit)
par(mfrow = c(2,2))
plot(best_fit)
g <- ggplot(data = mtcars, aes(x = am, y = mpg,fill = am))
g + geom_boxplot()
g + geom_boxplot() + labs(x = "Transmission Type",labels = c("Automatic","Manual"))
g + geom_boxplot() + labs(x = "Transmission Type",labels = am)
g + geom_boxplot() + labs(x = "Transmission Type",labels = mtcars$am)
g + geom_boxplot() + labs(x = "Transmission Type",labels = level(mtcars$am))
g <- ggplot(data = mtcars, aes(x = am, y = mpg,fill = am,labels=c("automatic","manual")))
g + geom_boxplot()
str(mtcars$am)
mtcars$am <- factor(mtcars$am,labels = c("automatic","manual"))
str(mtcars$am)
data("mtcars")
str(mtcars$am)
mtcars$am <- factor(mtcars$am,labels = c("automatic","manual"))
str(mtcars$am)
g <- ggplot(data = mtcars, aes(x = am, y = mpg,fill = am))
g + geom_boxplot()
confint(best_fit)
t.test(mpg~am)
t.test(mpg~am,data = mtcars)
summary(fit_am)
shapiro.test(mtcars$mpg)
shapiro.test(mtcars)
shapiro.test(mtcars$mpg~mtcars$am)
shapiro.test(mtcars$mpg)
t.test(mtcars$mpg~mtcars$am)
confint(t.test(mtcars$mpg~mtcars$am))
t.test(mtcars$mpg~mtcars$am)$coef
t.test(mtcars$mpg~mtcars$am)$p-value
p(t.test(mtcars$mpg~mtcars$am))
summary(t.test(mtcars$mpg~mtcars$am))
library(pander)
?lm
